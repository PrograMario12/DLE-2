<!--
This file represents the menu template for the DLE2 application.
It contains the HTML structure for the menu section of the application.
templates/menu.html

Author: [Abarca de Jesús Mario Adair]
Date: [2024-07-16]
-->
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Selección de Estación</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/normalize.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/menu_styles.css') }}"
    />
    <!-- Icons -->
    <link
      rel="stylesheet"
      href="https://cdn-uicons.flaticon.com/2.4.0/uicons-regular-rounded/css/uicons-regular-rounded.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn-uicons.flaticon.com/2.4.0/uicons-solid-rounded/css/uicons-solid-rounded.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn-uicons.flaticon.com/2.4.0/uicons-bold-rounded/css/uicons-bold-rounded.css"
    />
  </head>
  <body>
    <header class="header-container">
      <h2 class="line-title">{{ line }}</h2>
      <h1 class="main-title">Selecciona tu estación</h1>

      <div class="summary-metrics">
        <div class="metric-item">
          <i class="fi fi-sr-users-alt"></i>
          <span>Real: {{ total_employees }}</span>
        </div>
        <div class="metric-item">
          <i class="fi fi-rr-users-alt"></i>
          <span>Estándar: {{ total_capacity }}</span>
        </div>
        <div class="metric-item">
          <i class="fi fi-rr-exclamation"></i>
          <span>Diferencia: {{ total_capacity - total_employees }}</span>
        </div>
      </div>
    </header>

    <main class="main-content">
      <div class="stations-grid">
        {% for card in cards_main %} {% for side in card.sides %} {% set
        status_class = 'status-warning' %} {% if 'employee-ok' in side.class %}
        {% set status_class = 'status-ok' %} {% elif 'employee-nook' in
        side.class %} {% set status_class = 'status-warning' %} {% elif
        'employee-warning' in side.class %} {% set status_class =
        'status-danger' %} {% endif %}

        <a
          href="/successful?id={{ side.side_id }}"
          class="station-card"
          data-position="{{ card.position_name }}"
          data-side-id="{{ side.side_id }}"
        >
          <div class="card-header">
            <h3 class="station-name">
              {{ card.position_name }} {% if 'BP' not in side.side_title and
              'bp' not in side.side_title %}{{ side.side_title }}{% endif %}
            </h3>
          </div>

          <div class="card-body">
            <div class="status-indicator {{ status_class }}">
              {% if status_class == 'status-ok' %}
              <i class="fi fi-br-check"></i>
              {% else %}
              <i class="fi fi-br-exclamation"></i>
              {% endif %}
            </div>

            <div class="staff-info">
              <div class="staff-metric">
                <i class="fi fi-rr-user staff-icon"></i>
                <span class="staff-value">{{ side.employee_capacity }}</span>
                <span class="staff-label">Estándar</span>
              </div>
              <div class="staff-metric">
                <i class="fi fi-sr-user staff-icon"></i>
                <span class="staff-value">{{ side.employees_working }}</span>
                <span class="staff-label">Actual</span>
              </div>
            </div>
          </div>
        </a>
        {% endfor %} {% endfor %}
      </div>

      {% if has_afe %}
      <div class="afe-section">
        <h2 class="afe-title">Estaciones AFE</h2>
        <div class="stations-grid">
          {% for card in cards_afe %} {% for side in card.sides %} {% set
          status_class = 'status-warning' %} {% if 'employee-ok' in side.class
          %} {% set status_class = 'status-ok' %} {% elif 'employee-nook' in
          side.class %} {% set status_class = 'status-warning' %} {% elif
          'employee-warning' in side.class %} {% set status_class =
          'status-danger' %} {% endif %}

          <a
            href="/successful?id={{ side.side_id }}"
            class="station-card"
            data-position="{{ card.position_name }}"
            data-side-id="{{ side.side_id }}"
          >
            <div class="card-header">
              <h3 class="station-name">
                {{ card.position_name }} {% if 'BP' not in side.side_title and
                'bp' not in side.side_title %}{{ side.side_title }}{% endif %}
              </h3>
            </div>
            <div class="card-body">
              <div class="status-indicator {{ status_class }}">
                {% if status_class == 'status-ok' %}
                <i class="fi fi-br-check"></i>
                {% else %}
                <i class="fi fi-br-exclamation"></i>
                {% endif %}
              </div>
              <div class="staff-info">
                <div class="staff-metric">
                  <i class="fi fi-rr-user staff-icon"></i>
                  <span class="staff-value">{{ side.employee_capacity }}</span>
                  <span class="staff-label">Estándar</span>
                </div>
                <div class="staff-metric">
                  <i class="fi fi-sr-user staff-icon"></i>
                  <span class="staff-value">{{ side.employees_working }}</span>
                  <span class="staff-label">Actual</span>
                </div>
              </div>
            </div>
          </a>
          {% endfor %} {% endfor %}
        </div>
      </div>
      {% endif %}
    </main>

    <footer class="footer-actions">
      <button onclick="window.location.href='/'" class="btn-cancel">
        Cancelar
      </button>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll(".station-card").forEach(function (btn) {
          btn.addEventListener("click", function (e) {
            // Logic for AFE redirection if needed
            if (
              btn.dataset.position &&
              btn.dataset.position.trim().toUpperCase() === "AFE"
            ) {
              e.preventDefault();
              window.location.href = "/afeMenu?side_id=" + btn.dataset.sideId;
            }
          });
        });
      });
    </script>
  </body>
</html>
