{% extends 'base/base_dashboards.html' %} {% block title %} Ajustes {% endblock
%} {% block styles %} {# Asumiendo que los estilos de .button-4 est치n en tu CSS
principal #}
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/ajustes_styles.css') }}"
/>
{% endblock %} {% block header %}
<h1>Selecciona la l칤nea</h1>
{% endblock %} {% block content %}
<form
  class="settings-container"
  method="POST"
  action="{{ url_for('settings.configure_line_and_station') }}"
>
  <!-- Search Bar -->
  <div class="search-container">
    <input
      type="text"
      id="lineSearch"
      class="search-input"
      placeholder="游댌Buscar l칤nea..."
      autocomplete="off"
    />
  </div>

  {% for group, lines_in_group in grouped_lines.items() %}
  <details class="group-accordion" {% if loop.first %}open{% endif %}>
    <summary class="group-summary">
      {{ group|capitalize }}
      <span class="accordion-icon"></span>
    </summary>

    <div class="settings-group-grid">
      {% for line in lines_in_group %}
      <button
        class="button-4 button-4-settings capitalize {% if line['id'] == active_line %}button-4-select{% endif %}"
        type="submit"
        name="line"
        value="{{ line['id'] }}"
      >
        {# Puedes decidir aqu칤 c칩mo se forma el texto visible #} {% if
        line['type_zone'] == 'l칤nea' %} L칤nea {{ line['name'] }} {% else %} {{
        line['name'] }} {% endif %}
      </button>
      {% endfor %}
    </div>
  </details>
  {% endfor %}

  <div class="extra-actions">
    <button class="button-4" disabled>Salida general de l칤nea</button>
    <button class="button-4" disabled>Configuraci칩n de estaci칩n</button>
  </div>
</form>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const searchInput = document.getElementById("lineSearch");
    const accordions = document.querySelectorAll(".group-accordion");

    searchInput.addEventListener("input", function (e) {
      const searchTerm = e.target.value.toLowerCase().trim();

      accordions.forEach((accordion) => {
        const buttons = accordion.querySelectorAll(".button-4-settings");
        let hasVisibleButtons = false;

        buttons.forEach((btn) => {
          const text = btn.textContent.toLowerCase();
          if (text.includes(searchTerm)) {
            btn.style.display = ""; // Show
            hasVisibleButtons = true;
          } else {
            btn.style.display = "none"; // Hide
          }
        });

        // Show/Hide accordion based on matches
        if (hasVisibleButtons) {
          accordion.style.display = "";
          // Open accordion if searching
          if (searchTerm !== "") {
            accordion.open = true;
          }
        } else {
          accordion.style.display = "none";
        }
      });
    });
  });
</script>

{% endblock %}
